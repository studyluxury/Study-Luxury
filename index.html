<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="theme-color" content="#0b0f19" />
  <title>Study Reward</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header class="top">
    <div class="brand">
      <div class="title">Study Reward</div>
      <div class="subtitle">勉強記録 → グラフ → 達成スタンプ → ランダムご褒美</div>
    </div>

    <div class="wallet">
      <div class="walletRow">
        <div class="walletLabel">所持ポイント</div>
        <div class="walletValue"><span id="ptBalance">0</span> pt</div>
      </div>
      <div class="walletSub">保存：この端末（localStorage）</div>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <div class="cardHead">
        <h2>今日の勉強を記録</h2>
        <div class="pill">入力は16px固定（勝手に拡大しにくい）</div>
      </div>

      <div class="grid2">
        <label class="field">
          <span>科目</span>
          <input id="subject" type="text" placeholder="例：簿記論 / FP2級 / TOEIC" autocomplete="off" />
        </label>

        <label class="field">
          <span>勉強時間（分）</span>
          <div class="row">
            <input id="minutes" type="number" inputmode="numeric" min="0" step="5" placeholder="例：25" />
            <button class="mini" type="button" data-add-min="25">+25</button>
            <button class="mini" type="button" data-add-min="50">+50</button>
          </div>
          <div class="hint">※ 25分など「よく使う値」をボタンで追加できる</div>
        </label>

        <label class="field">
          <span>ページ数（任意）</span>
          <div class="row">
            <input id="pages" type="number" inputmode="numeric" min="0" step="1" placeholder="例：12" />
            <button class="mini" type="button" data-add-page="1">+1</button>
            <button class="mini" type="button" data-add-page="5">+5</button>
            <button class="mini" type="button" data-add-page="10">+10</button>
          </div>
          <div class="hint">スクロール地獄を防ぐため「打ち込み＋増減」方式</div>
        </label>

        <label class="field">
          <span>メモ（任意）</span>
          <input id="memo" type="text" placeholder="例：第3章/過去問/復習" autocomplete="off" />
        </label>
      </div>

      <div class="actions">
        <button id="saveLog" class="btn primary" type="button">記録してポイント加算</button>
        <button id="undoLast" class="btn" type="button">直前の記録を取り消し</button>
      </div>

      <div class="divider"></div>

      <div class="grid2">
        <div class="box">
          <h3>ポイント設定</h3>
          <div class="grid2">
            <label class="field">
              <span>目標時給（円）</span>
              <input id="hourlyYen" type="number" inputmode="numeric" min="0" placeholder="例：1500" />
            </label>
            <label class="field">
              <span>倍率（1.5 推奨）</span>
              <select id="multiplier">
                <option value="1.2">1.2</option>
                <option value="1.3">1.3</option>
                <option value="1.5" selected>1.5</option>
                <option value="1.8">1.8</option>
                <option value="2.0">2.0</option>
              </select>
            </label>
          </div>

          <label class="field">
            <span>1日の獲得上限（pt）</span>
            <input id="dailyCap" type="number" inputmode="numeric" min="0" placeholder="例：20000" />
            <div class="hint">「1日だいたい1.5万〜最大2万」なら 20000 がおすすめ</div>
          </label>

          <div class="actions">
            <button id="saveSettings" class="btn" type="button">設定を保存</button>
            <button id="resetAll" class="btn danger" type="button">全データ削除</button>
          </div>
        </div>

        <div class="box">
          <h3>ご褒美（何個でもOK・ランダム）</h3>

          <div class="row">
            <input id="rewardText" type="text" placeholder="例：カフェ / お菓子 / ピアノ / YouTube 30分" autocomplete="off" />
            <button id="addReward" class="btn" type="button">追加</button>
          </div>

          <div class="row">
            <label class="field compact">
              <span>必要ポイント（引く時）</span>
              <input id="rewardCost" type="number" inputmode="numeric" min="0" placeholder="例：5000" />
            </label>
            <button id="drawReward" class="btn primary" type="button">ランダムで選ぶ</button>
          </div>

          <ul id="rewardList" class="list"></ul>
          <div id="rewardResult" class="result"></div>
        </div>
      </div>
    </section>

    <section class="card">
      <div class="cardHead">
        <h2>分析</h2>
        <div class="pill">直近7日（棒グラフ） / 直近30日（円グラフ）</div>
      </div>

      <div class="grid2">
        <div class="chartBox">
          <h3>勉強時間（直近7日）</h3>
          <canvas id="bar7" width="640" height="220"></canvas>
          <div class="hint">※ 分→時間に換算して表示</div>
        </div>

        <div class="chartBox">
          <h3>科目割合（直近30日）</h3>
          <canvas id="pie30" width="640" height="220"></canvas>
          <div class="hint">※ 科目ごとの合計時間</div>
        </div>
      </div>
    </section>

    <section class="card">
      <div class="cardHead">
        <h2>達成カレンダー</h2>
        <div class="pill">押すと「ポン♪」でスタンプ</div>
      </div>

      <div class="calHead">
        <button id="prevMonth" class="btn" type="button">←</button>
        <div id="calTitle" class="calTitle">2026年2月</div>
        <button id="nextMonth" class="btn" type="button">→</button>
      </div>

      <div class="calLegend">
        <div class="legendDot"></div> スタンプ済み
      </div>

      <div id="calendar" class="calendar"></div>

      <div class="actions">
        <button id="stampToday" class="btn primary" type="button">今日にスタンプ</button>
        <button id="clearStampsMonth" class="btn" type="button">今月のスタンプ削除</button>
      </div>

      <!-- 効果音（外部ファイル不要。JSで鳴らす） -->
    </section>

    <section class="card">
      <div class="cardHead">
        <h2>履歴</h2>
        <div class="pill">最新50件</div>
      </div>

      <div id="logList" class="log"></div>
    </section>

    <footer class="foot">
      <div>※ データはこのブラウザ内に保存。別端末に自動同期はしない（安全寄り）。</div>
    </footer>
  </main>

  <script src="script.js"></script>
</body>
</html>
